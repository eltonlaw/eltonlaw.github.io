2:I[5613,[],""]
3:I[1778,[],""]
4:I[5250,["250","static/chunks/250-92aea3426083640b.js","404","static/chunks/app/blog/page-3a699f0cfd97bc37.js"],""]
0:["QNppb2vXGrtLjOuprCg2q",[[["",{"children":["blog",{"children":["2021-05-14-some-marlin-bugfixes",{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",{"children":["blog",{"children":["2021-05-14-some-marlin-bugfixes",{"children":["__PAGE__",{},["$L1",[["$","div",null,{"className":"postFrontmatter","children":[["$","h2",null,{"className":"PostFrontmatter_postTitle__fY2bg","children":"Some Marlin Bugfixes"}],["$","span",null,{"className":"PostFrontmatter_postDate__ncWjv","children":"2021-05-14 11:06PM"}]]}],"\n",["$","p",null,{"children":["I merged some code into ",["$","a",null,{"href":"https://github.com/MarlinFirmware/Marlin","children":"Marlin"}],"! I'm feeling very cool right now.  It was just two small bugfixes though."]}],"\n",["$","h3",null,{"children":["Allow disable of currently-required POWER_TIMEOUT ",["$","a",null,{"href":"https://github.com/MarlinFirmware/Marlin/pull/21771","children":"(#21771)"}]]}],"\n",["$","p",null,{"children":[["$","code",null,{"children":"AUTO_POWER_CONTROL"}]," is an energy-saving feature for automatically turning on and off an extra power supply (in dual supply setups) as needed. In ",["$","code",null,{"children":"bool Power::is_power_needed()"}]," there are checks to see if the extruder, chamber or cooler are above a certain temperature, in which case it'll turn on the PSU and power the fans for that component. Another piece of code that runs is in ",["$","code",null,{"children":"inline void manage_inactivity(const bool ignore_stepper_queue=false)"}]]}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"hljs language-cpp","children":"TERN_(AUTO_POWER_CONTROL, powerManager.check());\n"}]}],"\n",["$","p",null,{"children":"Which is defined as"}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"hljs language-cpp","children":"void Power::check() {\n  static millis_t nextPowerCheck = 0;\n  millis_t ms = millis();\n  if (ELAPSED(ms, nextPowerCheck)) {\n    nextPowerCheck = ms + 2500UL;\n    if (is_power_needed())\n      power_on();\n    else if (!lastPowerOn || ELAPSED(ms, lastPowerOn + SEC_TO_MS(POWER_TIMEOUT)))\n      power_off();\n  }\n}\n"}]}],"\n",["$","p",null,{"children":["The problem is ",["$","code",null,{"children":"POWER_TIMEOUT"}]," is assumed to be in the config, if you defined ",["$","code",null,{"children":"AUTO_POWER_CONTROL"}]," without it then you get a compile error, as brought up in this ",["$","a",null,{"href":"https://github.com/MarlinFirmware/Marlin/issues/21475","children":"issue"}]]}],"\n",["$","p",null,{"children":["The fix is straightforward, just handle that edge case somehow. I defined it to 0 if undefined and set it to only run the ",["$","code",null,{"children":"ELAPSED"}]," check if greater than 0: ",["$","a",null,{"href":"https://github.com/MarlinFirmware/Marlin/pull/21771/files","children":"https://github.com/MarlinFirmware/Marlin/pull/21771/files"}]]}],"\n",["$","h3",null,{"children":["Fix G5 IJ with Motion Mode ",["$","a",null,{"href":"https://github.com/MarlinFirmware/Marlin/pull/21858","children":"(#21858)"}]]}],"\n",["$","p",null,{"children":[["$","a",null,{"href":"https://marlinfw.org/docs/gcode/G005.html","children":"G5"}]," is the gcode command for creating cubic B-splines and it has optional parameters ",["$","code",null,{"children":"I<pos>"}]," and ",["$","code",null,{"children":"J<pos>"}]," for setting offsets. The parser logic was ignoring these since there's some error checking at the beginning of ",["$","code",null,{"children":"void GCodeParser::parse(char *p)"}],", making it bail out if there's something unexpected. ",["$","code",null,{"children":"I"}]," and ",["$","code",null,{"children":"J"}]," was only expected to be passed in for ",["$","code",null,{"children":"G2"}]," and ",["$","code",null,{"children":"G3"}]," if arc support was enabled."]}],"\n",["$","pre",null,{"children":["$","code",null,{"className":"hljs language-cpp","children":"    #if ENABLED(GCODE_MOTION_MODES)\n      case 'I' ... 'J':\n        if (motion_mode_codenum != 5 && \\\n            TERN1(ARC_SUPPORT, motion_mode_codenum != 2 && motion_mode_codenum != 3)) return;\n"}]}],"\n",["$","p",null,{"children":["So the fix for this was also straightforward, just set it to allow ",["$","code",null,{"children":"I"}]," and ",["$","code",null,{"children":"J"}]," for ",["$","code",null,{"children":"G5"}]," as well: ",["$","a",null,{"href":"https://github.com/MarlinFirmware/Marlin/pull/21858/commits/16c6e923e016e27d9488dfa254e5c82faaeb94db","children":"https://github.com/MarlinFirmware/Marlin/pull/21858/commits/16c6e923e016e27d9488dfa254e5c82faaeb94db"}]]}]],null]]},["$","$L2",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","2021-05-14-some-marlin-bugfixes","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/bd17e4652862e3d3.css","precedence":"next","crossOrigin":""}]]}]]},["$","$L2",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]]},[null,["$","html",null,{"lang":"en","children":["$","body",null,{"children":["$","div",null,{"className":"RootLayout_container__tH3RP","children":[["$","div",null,{"className":"RootLayout_masthead__LsRd7","children":[["$","h3",null,{"className":"$undefined","children":[["$","$L4",null,{"className":"RootLayout_titleLink__VQPJ9","href":"/","children":"eltonlaw"}],["$","small",null,{"children":" sundries"}]]}],["$","$L4",null,{"className":"RootLayout_titleLink__VQPJ9","href":"https://github.com/eltonlaw","children":["$","svg",null,{"viewBox":"0 0 16 16","width":"16px","height":"16px","children":["$","path",null,{"fill":"#828282","d":"M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"}]}]}]]}],["$","$L2",null,{"parallelRouterKey":"children","segmentPath":["children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":[],"styles":null}]]}]}]}],null]],[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/5d82fb85d7740057.css","precedence":"next","crossOrigin":""}]],"$L5"]]]]
5:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"eltonlaw"}]]
1:null
